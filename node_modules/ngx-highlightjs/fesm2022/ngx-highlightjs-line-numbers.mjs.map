{"version":3,"file":"ngx-highlightjs-line-numbers.mjs","sources":["../../../projects/ngx-highlightjs/line-numbers/src/line-numbers-lib.ts","../../../projects/ngx-highlightjs/line-numbers/src/line-numbers.ts","../../../projects/ngx-highlightjs/line-numbers/src/ngx-highlightjs-line-numbers.ts"],"sourcesContent":["export function activateLineNumbers() {\r\n  const w: any = window;\r\n  const d: Document = document;\r\n\r\n  const TABLE_NAME: string = 'hljs-ln',\r\n    LINE_NAME: string = 'hljs-ln-line',\r\n    CODE_BLOCK_NAME: string = 'hljs-ln-code',\r\n    NUMBERS_BLOCK_NAME: string = 'hljs-ln-numbers',\r\n    NUMBER_LINE_NAME: string = 'hljs-ln-n',\r\n    DATA_ATTR_NAME: string = 'data-line-number',\r\n    BREAK_LINE_REGEXP: RegExp = /\\r\\n|\\r|\\n/g;\r\n\r\n  if (w.hljs) {\r\n    w.hljs.initLineNumbersOnLoad = initLineNumbersOnLoad;\r\n    w.hljs.lineNumbersBlock = lineNumbersBlock;\r\n    w.hljs.lineNumbersValue = lineNumbersValue;\r\n\r\n    addStyles();\r\n  } else {\r\n    w.console.error('highlight.js not detected!');\r\n  }\r\n\r\n  function isHljsLnCodeDescendant(domElt): boolean {\r\n    let curElt = domElt;\r\n    while (curElt) {\r\n      if (curElt.className && curElt.className.indexOf('hljs-ln-code') !== -1) {\r\n        return true;\r\n      }\r\n      curElt = curElt.parentNode;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  function getHljsLnTable(hljsLnDomElt) {\r\n    let curElt = hljsLnDomElt;\r\n    while (curElt.nodeName !== 'TABLE') {\r\n      curElt = curElt.parentNode;\r\n    }\r\n    return curElt;\r\n  }\r\n\r\n  // Function to workaround a copy issue with Microsoft Edge.\r\n  // Due to hljs-ln wrapping the lines of code inside a <table> element,\r\n  // itself wrapped inside a <pre> element, window.getSelection().toString()\r\n  // does not contain any line breaks. So we need to get them back using the\r\n  // rendered code in the DOM as reference.\r\n  function edgeGetSelectedCodeLines(selection) {\r\n    // current selected text without line breaks\r\n    const selectionText = selection.toString();\r\n\r\n    // get the <td> element wrapping the first line of selected code\r\n    let tdAnchor = selection.anchorNode;\r\n    while (tdAnchor.nodeName !== 'TD') {\r\n      tdAnchor = tdAnchor.parentNode;\r\n    }\r\n\r\n    // get the <td> element wrapping the last line of selected code\r\n    let tdFocus = selection.focusNode;\r\n    while (tdFocus.nodeName !== 'TD') {\r\n      tdFocus = tdFocus.parentNode;\r\n    }\r\n\r\n    // extract line numbers\r\n    let firstLineNumber = parseInt(tdAnchor.dataset.lineNumber);\r\n    let lastLineNumber = parseInt(tdFocus.dataset.lineNumber);\r\n\r\n    // multi-lines copied case\r\n    if (firstLineNumber != lastLineNumber) {\r\n\r\n      let firstLineText = tdAnchor.textContent;\r\n      let lastLineText = tdFocus.textContent;\r\n\r\n      // if the selection was made backward, swap values\r\n      if (firstLineNumber > lastLineNumber) {\r\n        let tmp = firstLineNumber;\r\n        firstLineNumber = lastLineNumber;\r\n        lastLineNumber = tmp;\r\n        tmp = firstLineText;\r\n        firstLineText = lastLineText;\r\n        lastLineText = tmp;\r\n      }\r\n\r\n      // discard not copied characters in first line\r\n      while (selectionText.indexOf(firstLineText) !== 0) {\r\n        firstLineText = firstLineText.slice(1);\r\n      }\r\n\r\n      // discard not copied characters in last line\r\n      while (selectionText.lastIndexOf(lastLineText) === -1) {\r\n        lastLineText = lastLineText.slice(0, -1);\r\n      }\r\n\r\n      // reconstruct and return the real copied text\r\n      let selectedText = firstLineText;\r\n      const hljsLnTable = getHljsLnTable(tdAnchor);\r\n      for (let i: number = firstLineNumber + 1; i < lastLineNumber; ++i) {\r\n        const codeLineSel = format('.{0}[{1}=\"{2}\"]', [CODE_BLOCK_NAME, DATA_ATTR_NAME, i]);\r\n        const codeLineElt = hljsLnTable.querySelector(codeLineSel);\r\n        selectedText += '\\n' + codeLineElt.textContent;\r\n      }\r\n      selectedText += '\\n' + lastLineText;\r\n      return selectedText;\r\n      // single copied line case\r\n    } else {\r\n      return selectionText;\r\n    }\r\n  }\r\n\r\n  // ensure consistent code copy/paste behavior across all browsers\r\n  // (see https://github.com/wcoder/highlightjs-line-numbers.js/issues/51)\r\n  document.addEventListener('copy', function (e: ClipboardEvent) {\r\n    // get current selection\r\n    const selection: Selection = window.getSelection();\r\n    // override behavior when one wants to copy line of codes\r\n    if (isHljsLnCodeDescendant(selection.anchorNode)) {\r\n      let selectionText;\r\n      // workaround an issue with Microsoft Edge as copied line breaks\r\n      // are removed otherwise from the selection string\r\n      if (window.navigator.userAgent.indexOf('Edge') !== -1) {\r\n        selectionText = edgeGetSelectedCodeLines(selection);\r\n      } else {\r\n        // other browsers can directly use the selection string\r\n        selectionText = selection.toString();\r\n      }\r\n      e.clipboardData.setData('text/plain', selectionText);\r\n      e.preventDefault();\r\n    }\r\n  });\r\n\r\n  function addStyles() {\r\n    const css: HTMLStyleElement = d.createElement('style');\r\n    css.type = 'text/css';\r\n    css.innerHTML = format(\r\n      '.{0}{border-collapse:collapse}' +\r\n      '.{0} td{padding:0}' +\r\n      '.{1}:before{content:attr({2})}',\r\n      [\r\n        TABLE_NAME,\r\n        NUMBER_LINE_NAME,\r\n        DATA_ATTR_NAME\r\n      ]);\r\n    d.getElementsByTagName('head')[0].appendChild(css);\r\n  }\r\n\r\n  function initLineNumbersOnLoad(options) {\r\n    if (d.readyState === 'interactive' || d.readyState === 'complete') {\r\n      documentReady(options);\r\n    } else {\r\n      w.addEventListener('DOMContentLoaded', function () {\r\n        documentReady(options);\r\n      });\r\n    }\r\n  }\r\n\r\n  function documentReady(options): void {\r\n    try {\r\n      const blocks: NodeListOf<Element> = d.querySelectorAll('code.hljs,code.nohighlight');\r\n\r\n      for (const i in blocks) {\r\n        if (blocks.hasOwnProperty(i)) {\r\n          if (!isPluginDisabledForBlock(blocks[i])) {\r\n            lineNumbersBlock(blocks[i], options);\r\n          }\r\n        }\r\n      }\r\n    } catch (e) {\r\n      w.console.error('LineNumbers error: ', e);\r\n    }\r\n  }\r\n\r\n  function isPluginDisabledForBlock(element) {\r\n    return element.classList.contains('nohljsln');\r\n  }\r\n\r\n  function lineNumbersBlock(element, options) {\r\n    if (typeof element !== 'object') {\r\n      return;\r\n    }\r\n\r\n    async(function () {\r\n      element.innerHTML = lineNumbersInternal(element, options);\r\n    });\r\n  }\r\n\r\n  function lineNumbersValue(value, options) {\r\n    if (typeof value !== 'string') {\r\n      return;\r\n    }\r\n\r\n    const element: HTMLElement = document.createElement('code');\r\n    element.innerHTML = value;\r\n\r\n    return lineNumbersInternal(element, options);\r\n  }\r\n\r\n  function lineNumbersInternal(element, options) {\r\n\r\n    const internalOptions = mapOptions(element, options);\r\n\r\n    duplicateMultilineNodes(element);\r\n\r\n    return addLineNumbersBlockFor(element.innerHTML, internalOptions);\r\n  }\r\n\r\n  function addLineNumbersBlockFor(inputHtml, options) {\r\n    const lines = getLines(inputHtml);\r\n\r\n    // if last line contains only carriage return remove it\r\n    if (lines[lines.length - 1].trim() === '') {\r\n      lines.pop();\r\n    }\r\n\r\n    if (lines.length > 1 || options.singleLine) {\r\n      let html = '';\r\n\r\n      for (let i = 0, l = lines.length; i < l; i++) {\r\n        html += format(\r\n          '<tr>' +\r\n          '<td class=\"{0} {1}\" {3}=\"{5}\">' +\r\n          '<div class=\"{2}\" {3}=\"{5}\"></div>' +\r\n          '</td>' +\r\n          '<td class=\"{0} {4}\" {3}=\"{5}\">' +\r\n          '{6}' +\r\n          '</td>' +\r\n          '</tr>',\r\n          [\r\n            LINE_NAME,\r\n            NUMBERS_BLOCK_NAME,\r\n            NUMBER_LINE_NAME,\r\n            DATA_ATTR_NAME,\r\n            CODE_BLOCK_NAME,\r\n            i + options.startFrom,\r\n            lines[i].length > 0 ? lines[i] : ' '\r\n          ]);\r\n      }\r\n\r\n      return format('<table class=\"{0}\">{1}</table>', [TABLE_NAME, html]);\r\n    }\r\n\r\n    return inputHtml;\r\n  }\r\n\r\n  /**\r\n   * @param {HTMLElement} element Code block.\r\n   * @param {Object} options External API options.\r\n   * @returns {Object} Internal API options.\r\n   */\r\n  function mapOptions(element, options) {\r\n    options = options || {};\r\n    return {\r\n      singleLine: getSingleLineOption(options),\r\n      startFrom: getStartFromOption(element, options)\r\n    };\r\n  }\r\n\r\n  function getSingleLineOption(options) {\r\n    const defaultValue: boolean = false;\r\n    if (options.singleLine) {\r\n      return options.singleLine;\r\n    }\r\n    return defaultValue;\r\n  }\r\n\r\n  function getStartFromOption(element, options) {\r\n    const defaultValue: number = 1;\r\n    let startFrom: number = defaultValue;\r\n\r\n    if (isFinite(options.startFrom)) {\r\n      startFrom = options.startFrom;\r\n    }\r\n\r\n    // can be overridden because local option is priority\r\n    const value = getAttribute(element, 'data-ln-start-from');\r\n    if (value !== null) {\r\n      startFrom = toNumber(value, defaultValue);\r\n    }\r\n\r\n    return startFrom;\r\n  }\r\n\r\n  /**\r\n   * Recursive method for fix multi-line elements implementation in highlight.js\r\n   * Doing deep passage on child nodes.\r\n   * @param {HTMLElement} element\r\n   */\r\n  function duplicateMultilineNodes(element) {\r\n    const nodes = element.childNodes;\r\n    for (const node in nodes) {\r\n      if (nodes.hasOwnProperty(node)) {\r\n        const child = nodes[node];\r\n        if (getLinesCount(child.textContent) > 0) {\r\n          if (child.childNodes.length > 0) {\r\n            duplicateMultilineNodes(child);\r\n          } else {\r\n            duplicateMultilineNode(child.parentNode);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Method for fix multi-line elements implementation in highlight.js\r\n   * @param {HTMLElement} element\r\n   */\r\n  function duplicateMultilineNode(element) {\r\n    const className = element.className;\r\n\r\n    if (!/hljs-/.test(className)) {\r\n      return;\r\n    }\r\n\r\n    const lines = getLines(element.innerHTML);\r\n    let result: string = '';\r\n\r\n    for (let i: number = 0; i < lines.length; i++) {\r\n      const lineText = lines[i].length > 0 ? lines[i] : ' ';\r\n      result += format('<span class=\"{0}\">{1}</span>\\n', [className, lineText]);\r\n    }\r\n\r\n    element.innerHTML = result.trim();\r\n  }\r\n\r\n  function getLines(text) {\r\n    if (text.length === 0) {\r\n      return [];\r\n    }\r\n    return text.split(BREAK_LINE_REGEXP);\r\n  }\r\n\r\n  function getLinesCount(text) {\r\n    return (text.trim().match(BREAK_LINE_REGEXP) || []).length;\r\n  }\r\n\r\n  ///\r\n  /// HELPERS\r\n  ///\r\n\r\n  function async(func) {\r\n    w.setTimeout(func, 0);\r\n  }\r\n\r\n  /**\r\n   * {@link https://wcoder.github.io/notes/string-format-for-string-formating-in-javascript}\r\n   * @param {string} format\r\n   * @param {array} args\r\n   */\r\n  function format(format, args) {\r\n    return format.replace(/\\{(\\d+)\\}/g, function (m, n) {\r\n      return args[n] !== undefined ? args[n] : m;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @param {HTMLElement} element Code block.\r\n   * @param {String} attrName Attribute name.\r\n   * @returns {String} Attribute value or empty.\r\n   */\r\n  function getAttribute(element, attrName) {\r\n    return element.hasAttribute(attrName) ? element.getAttribute(attrName) : null;\r\n  }\r\n\r\n  /**\r\n   * @param {String} str Source string.\r\n   * @param {Number} fallback Fallback value.\r\n   * @returns Parsed number or fallback value.\r\n   */\r\n  function toNumber(str, fallback) {\r\n    if (!str) {\r\n      return fallback;\r\n    }\r\n    const number: number = Number(str);\r\n    return isFinite(number) ? number : fallback;\r\n  }\r\n}\r\n","import {\r\n  Directive,\r\n  Input,\r\n  inject,\r\n  effect,\r\n  numberAttribute,\r\n  booleanAttribute,\r\n  ElementRef,\r\n  PLATFORM_ID\r\n} from '@angular/core';\r\nimport { isPlatformBrowser } from '@angular/common';\r\nimport { HighlightJS, HighlightBase, HIGHLIGHT_OPTIONS, LineNumbersOptions } from 'ngx-highlightjs';\r\n\r\n@Directive({\r\n  standalone: true,\r\n  selector: '[highlight][lineNumbers], [highlightAuto][lineNumbers]'\r\n})\r\nexport class HighlightLineNumbers {\r\n\r\n  private readonly _platform: object = inject(PLATFORM_ID);\r\n  private readonly options: LineNumbersOptions = inject(HIGHLIGHT_OPTIONS)?.lineNumbersOptions;\r\n  private readonly _hljs: HighlightJS = inject(HighlightJS);\r\n  private readonly _highlight: HighlightBase = inject(HighlightBase);\r\n  private readonly _nativeElement: HTMLElement = inject(ElementRef<HTMLElement>).nativeElement;\r\n\r\n  // Temp observer to observe when line numbers has been added to code element\r\n  private _lineNumbersObs: MutationObserver;\r\n\r\n  @Input({ transform: numberAttribute }) startFrom: number = this.options?.startFrom;\r\n\r\n  @Input({ transform: booleanAttribute }) singleLine: boolean = this.options?.singleLine;\r\n\r\n  constructor() {\r\n    if (isPlatformBrowser(this._platform)) {\r\n      effect(() => {\r\n        if (this._highlight.highlightResult()) {\r\n          this.addLineNumbers();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  private addLineNumbers(): void {\r\n    // Clean up line numbers observer\r\n    this.destroyLineNumbersObserver();\r\n    requestAnimationFrame(async () => {\r\n      // Add line numbers\r\n      await this._hljs.lineNumbersBlock(this._nativeElement, {\r\n        startFrom: this.startFrom,\r\n        singleLine: this.singleLine\r\n      });\r\n      // If lines count is 1, the line numbers library will not add numbers\r\n      // Observe changes to add 'hljs-line-numbers' class only when line numbers is added to the code element\r\n      this._lineNumbersObs = new MutationObserver(() => {\r\n        if (this._nativeElement.firstElementChild?.tagName.toUpperCase() === 'TABLE') {\r\n          this._nativeElement.classList.add('hljs-line-numbers');\r\n        }\r\n        this.destroyLineNumbersObserver();\r\n      });\r\n      this._lineNumbersObs.observe(this._nativeElement, { childList: true });\r\n    });\r\n  }\r\n\r\n  private destroyLineNumbersObserver(): void {\r\n    if (this._lineNumbersObs) {\r\n      this._lineNumbersObs.disconnect();\r\n      this._lineNumbersObs = null;\r\n    }\r\n  }\r\n}\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}